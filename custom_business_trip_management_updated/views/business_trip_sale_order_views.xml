<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Custom tree view with JavaScript redirection to handle user interaction.
         This redirection ensures that when a user selects a quotation, 
         they are redirected to the appropriate business trip-related functionality. -->
    <record id="view_sale_order_tree_trip_redirect_custom" model="ir.ui.view">
        <field name="name">sale.order.tree.trip.custom</field>
        <field name="model">sale.order</field>
        <field name="arch" type="xml">
            <tree string="Quotations for Business Trip" js_class="custom_trip_redirect" create="false" edit="false" multi_edit="0" decoration-info="state == 'draft'" decoration-success="state == 'sale'" decoration-warning="state == 'sent'">
                <field name="name"/>
                <field name="partner_id"/>
                <field name="amount_total"/>
                <field name="date_order"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="action_sale_order_trip_custom" model="ir.actions.act_window">
        <field name="name">Select Quotation</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_sale_order_tree_trip_redirect_custom"/>
        <field name="domain">[('state', 'in', ['draft', 'sent', 'sale'])]</field>
        <field name="context">{'custom_trip_context': True}</field>
    </record>

    <record id="menu_select_quotation_for_trip" model="ir.ui.menu">
        <field name="name">Select Quotation</field>
        <field name="parent_id" ref="custom_business_trip_management.menu_business_trip_root"/>
        <field name="action" ref="action_sale_order_trip_custom"/>
        <field name="sequence">3</field>
    </record>
</odoo>
